\section{Cast Usage Patterns}
\label{sec:casts:patterns}

Using the methodology described in the above section, we have devised \npattern{} casts usage patterns.%
\footnote{We have excluded casts that represents primitive numeric type conversions, as they do not represent any pattern.
However, during our manual analysis we found \nprim{} primitive conversions.
Moreover, we found \nbrokenlinks{} links that were not accessible during our analysis.}
In this section we present the cast usage patterns we found.
The manual categorization can be found online.%
\footnote{\url{https://gitlab.com/acuarica/phd-thesis/blob/master/analysis/casts-5000.csv}}
To ease the patterns presentation, we have clustered them in \ngroup{} groups according to their purpose.
Table~\ref{table:casts:patterns} presents each pattern and the groups they belong to.
Moreover, we are interested in the scope of the cast instance, \ie, \emph{does it appear in application source code, test code, or generated code?}
Figure~\ref{fig:patterns} shows our patterns and their occurrences sort by frequency.
The column on the right correspond to the group the pattern belongs to.

\input{chapters/casts/table-patterns}

\begin{figure}[ht!]
\centering
\includegraphics[width=\textwidth]{analysis/table-patterns-5000.pdf}
\caption{Cast Patterns Occurrences} \label{fig:patterns}
\end{figure}

Each pattern is described using the following template:

\begin{itemize}
\item \textbf{Description.}
Tells what is this pattern about.
It gives a general overview of the structure of the pattern.
\item \textbf{Instances.}
Gives one or more concrete examples found in real code.%
\footnote{Please notice that the snippets presented here were slightly
modified for formatting purposes.
Moreover, to facilitate some snippet presentations,
we remove irrelevant code and replace it with the
comment \code{// [...]}.}
For each instance presented here, we provide the link to the source code repository in \lgtm{}.
We provide the link in case the reader wants to do further inspection
of the snippet presented.%
\footnote{Instead of presenting \lgtm{} long URLs,
we have used the URL shortening service \url{https://bitly.com/}
for an easier reading.}
\item \textbf{Detection.}
Describes briefly how this pattern was detected in terms of the tags introduced in the previous section.
\item \textbf{Discussion.}
Presents suggestions, flaws, or comments about the pattern.
\item \textbf{Related Patterns.}
How the pattern being described relates to other patterns?
\end{itemize}

\group{Guarded}

The patterns in this group are guarded casts, \ie, before the cast is applied some condition needs to be verified.

\input{chapters/casts/PatternMatching}
\input{chapters/casts/TypeTag}
\input{chapters/casts/Equals}
\input{chapters/casts/GetByClassLiteral}

\group{Creational}

These patterns creates to how they are created.

\input{chapters/casts/Family}
\input{chapters/casts/Factory}
\input{chapters/casts/KnownLibraryMethod}
\input{chapters/casts/Tag}
\input{chapters/casts/Deserialization}
\input{chapters/casts/StackSymbol}
\input{chapters/casts/CreateByClassLiteral}

\group{Tuples}

Tuples patterns.

\input{chapters/casts/LookupById}
\input{chapters/casts/StaticResource}
\input{chapters/casts/ObjectAsArray}

\group{Member Resolution}

\input{chapters/casts/SelectOverload}
\input{chapters/casts/AccessPrivateField}

\group{Variance}

\input{chapters/casts/Clone}
\input{chapters/casts/CovariantReturn}
\input{chapters/casts/RemoveTypeParameter}

\group{Implicit Types}

\input{chapters/casts/ImplicitIntersectionType}
\input{chapters/casts/ImplicitUnionType}

\group{Structural}

\input{chapters/casts/SoleSubclassImplementation}
\input{chapters/casts/RecursiveGeneric}

\group{Reflection}

\input{chapters/casts/NewDynamicInstance}
\input{chapters/casts/ReflectiveAccessibility}

\group{Unchecked}

\input{chapters/casts/UncheckedCast}
\input{chapters/casts/GenericArray}
\input{chapters/casts/RemoveWildcard}

\group{Code Smell}

These are code smells.

\input{chapters/casts/Literal}
\input{chapters/casts/RawTypes}
\input{chapters/casts/Redundant}
\input{chapters/casts/VariableLessSpecificType}

% * keep reference \cite{altidorTamingWildcardsCombining2011}
