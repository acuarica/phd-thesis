\begin{pattern}{ObjectAsArray}
In this pattern an array is used as an untyped object.
A cast is applied to a constant array slot, \eg, \code{(String) array[1]}.

\instances{}
The following example%
\footnote{\url{http://bit.ly/datanucleus_datanucleus-core_2S1L5Zf}}
shows an instance of the \thisp{} pattern.
The variable \code{currentState} contains an \code{Object[]} with a fixed
schema.%
\footnote{\url{http://www.datanucleus.org/javadocs/core/5.0/org/datanucleus/enhancement/Detachable.html}}
A cast is performed of a constant array slot, \code{(BitSet) currentState[3]} on line 5.

%https://lgtm.com/projects/g/datanucleus/datanucleus-core/snapshot/dist-14100061-1524814812150/files/src/main/java/org/datanucleus/state/StateManagerImpl.java?sort=name&dir=ASC&mode=heatmap#L3324
\begin{minted}[highlightlines=5]{java}
        BitSet theLoadedFields = (BitSet)currentState[2];
        for (int i = 0; i < this.loadedFields.length; i++) {
            this.loadedFields[i] = theLoadedFields.get(i);
        }
        BitSet theModifiedFields = (BitSet)currentState[3];
        for (int i = 0; i < dirtyFields.length; i++) {
            dirtyFields[i] = theModifiedFields.get(i);
        }
        setVersion(currentState[1]);
\end{minted}

\discussion{}
This pattern usually suggests an abuse of the type system.
Using an object with statically typed fields might be a better alternative.

\end{pattern}
